<!DOCTYPE html>
<html style="height: 100%; margin: 0";>
<head>
<title>arteBA - mapa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
<link rel="stylesheet" href="scripts/leaflet/leaflet.css">
<script src="scripts/leaflet/leaflet.js"></script>
</head>
<body style="height: 100%; margin: 0";>
	<div name="select-location" id="select-location" style="z-index: 1; text-align: center; padding: 10px;">
		<p style="margin: 10px">Seleccione una exhibición</p>
        <div class="btn-group" role="group" aria-label="Basic example">
		<button type="button" class="btn btn-secondary" value="-11.523088, -1.757813">Exhibición A</button>
		<button type="button" class="btn btn-secondary" value="37.71859, 37.617188">Exhibición B</button>	
		<button type="button" class="btn btn-secondary" value="35.46067, -80.859375">Exhibición C</button>
        <button type="button" class="btn btn-outline-secondary" value="0">Ver mapa completo</button>			
    </div>
    </div>
<div id="map" style="width: 100%; height: 90%; margin: 0; background: #FFFFFF">

</div>
<script type="text/javascript">

// declara el objeto mapa
var mapSW = [0, 4096],
    mapNE = [4096, 0]

var map = L.map('map').setView([0, 0], 1);

// referenciar tiles
L.tileLayer('maps/map_arteba/{z}/{x}/{y}.png', {
    minZoom: 1,
    maxZoom: 4,
    continuousWorld: false,
    noWrap: true,
    crs: L.CRS.Simple,

}).addTo(map)

map.setMaxBounds(new L.LatLngBounds(

    map.unproject(mapSW, map.getMaxZoom()),
    map.unproject(mapNE, map.getMaxZoom())
));

// Markers and popups

var marker = L.marker([0, 0], {
    draggable: true,
})/* .addTo(map) */;
marker.bindPopup('');

var marker_1a = L.marker([-11.523088, -1.757813]).bindPopup('Exhibición 1A');

var marker_2a = L.marker([37.71859, 37.617188]).bindPopup('Exhibición 2A');

var marker_3a = L.marker([35.46067, -80.859375]).bindPopup('Exhibición 3A');

var marker_1b = L.marker([57.326521, -65.390625]).bindPopup('Exhibición 1B');

var marker_2b = L.marker([62.915233, 89.648438]).bindPopup('Exhibición 2B');

var marker_3b = L.marker([-47.989922, -91.40625]).bindPopup('Exhibición 3B');

var marker_1c = L.marker([-23.241346, 132.539063]).bindPopup('Exhibición 1C');



// layer groups

var lg_a = L.layerGroup([marker_1a, marker_2a, marker_3a]);

var lg_b = L.layerGroup([marker_1b, marker_2b, marker_3b]);

var lg_c = L.layerGroup([marker_1c]);

var latlngs = [
[-11.523088, -1.757813],
[37.71859, 37.617188],
[35.46067, -80.859375]
];

var polyline = L.polyline(latlngs, {color: 'red'});

var overlays = {
    "Exhibiciones A" : lg_a,
    "Exhibiciones B" : lg_b,
    "Exhibiciones C" : lg_c,
    "Recorrido 1" : polyline,
}

// Layer controls

L.control.layers(null, overlays).addTo(map);


marker.on('dragend', function(e) {
    // alert(marker.getLatLng().toString());
    marker.getPopup().setContent('Clicked' + marker.getLatLng().toString()).openOn(map)
} );

document.getElementById('select-location').addEventListener('click',function(e){
    let coords = e.target.value.split(",");
    if(e.target.value != "0"){
    map.flyTo(coords,4);
    L.marker([-11.523088, -1.757813]).bindPopup('Exhibición 1A').addTo(map);
    }
    else {map.flyTo([0, 0],1)}
})

window.addEventListener('load', function() {
    if(window.location.hash) {
         var hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
         if(hash == 'aqui1') {
            map.flyTo([-11.523088, -1.757813],2);
    L.marker([-11.523088, -1.757813]).bindPopup('Usted está aquí').addTo(map).openPopup();
         } 
         if(hash == 'aqui2') {
            map.flyTo([-23.241346, 132.539063],2);
    L.marker([-61.523088, 20.757813]).bindPopup('Usted está aquí').addTo(map).openPopup();
         } 
         if(hash == 'aqui3') {
            map.flyTo([35.46067, -80.859375],2);
    L.marker([-32.523088, 3.757813]).bindPopup('Usted está aquí').addTo(map).openPopup();
         } 
    }
}, false);

</script>

</body>
</html>